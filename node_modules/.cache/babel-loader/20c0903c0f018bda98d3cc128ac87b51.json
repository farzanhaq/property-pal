{"ast":null,"code":"var _jsxFileName = \"/Users/farzanhaq/Desktop/PropertyPal/src/components/Booking/Identification/Identification.tsx\",\n    _s = $RefreshSig$();\n\nimport { LoadingOutlined, PlusOutlined, RightOutlined } from \"@ant-design/icons\";\nimport { Button, message, Space, Typography } from \"antd\";\nimport { Auth, Storage } from \"aws-amplify\";\nimport { useContext, useState } from \"react\";\nimport { BookingStatusContext } from \"../../../utils/BookingState\";\nimport { StyledButtonNavDiv, StyledContentDiv, StyledIdentificationDiv, StyledIdentificationUploadDiv } from \"../../Styles/Div.style\";\nimport { StyledIdentificationUploadImage } from \"../../Styles/Image.style\";\nimport { StyledPrompt } from \"../../Styles/Title.style\";\nimport { StyledIdentificationUploader } from \"../../Styles/Upload.style\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst getBase64 = (img, callback) => {\n  const reader = new FileReader();\n  reader.addEventListener(\"load\", () => callback(reader.result));\n  reader.readAsDataURL(img);\n};\n\nconst beforeUpload = file => {\n  const isJpgOrPng = file.type === \"image/jpeg\" || file.type === \"image/png\";\n\n  if (!isJpgOrPng) {\n    message.error(\"Please upload a JPG/PNG file\");\n  }\n\n  const isLt2M = file.size / 1024 / 1024 < 2;\n\n  if (!isLt2M) {\n    message.error(\"Image must smaller than 2MB\");\n  }\n\n  performUpload(file);\n  return isJpgOrPng && isLt2M;\n};\n\nconst performUpload = async file => {\n  try {\n    const user = await Auth.currentAuthenticatedUser();\n    console.log(user);\n    const result = await Storage.put(`identifications/${user.attributes.sub}`, file);\n    const userWithPicture = await Auth.updateUserAttributes(user, {\n      'picture': result.key\n    });\n    console.log(userWithPicture);\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst Identification = () => {\n  _s();\n\n  const {\n    currentStep,\n    setCurrentStep\n  } = useContext(BookingStatusContext);\n  const [loading, setLoading] = useState(false);\n  const [imageUrl, setImageUrl] = useState(\"\");\n\n  const handleChange = info => {\n    console.log(info);\n\n    if (info.file.status === \"uploading\") {\n      setLoading(true);\n      return;\n    }\n\n    if (info.file.status === \"done\") {\n      // Get this url from response in real world.\n      getBase64(info.file.originFileObj, imageUrl => {\n        setImageUrl(imageUrl);\n        setLoading(false);\n      });\n    }\n  };\n\n  const uploadButton = /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [loading ? /*#__PURE__*/_jsxDEV(LoadingOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 18\n    }, this) : /*#__PURE__*/_jsxDEV(PlusOutlined, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 40\n    }, this), /*#__PURE__*/_jsxDEV(StyledIdentificationUploadDiv, {\n      children: \"Upload\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 90,\n    columnNumber: 5\n  }, this);\n\n  const customRequest = options => {\n    const {\n      onSuccess,\n      file\n    } = options;\n    console.log(file);\n    setTimeout(() => {\n      onSuccess(\"ok\");\n    }, 0);\n  };\n\n  return /*#__PURE__*/_jsxDEV(StyledIdentificationDiv, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      children: /*#__PURE__*/_jsxDEV(StyledPrompt, {\n        level: 5,\n        children: \"Please upload a photo of your drivers license\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(StyledContentDiv, {\n      children: /*#__PURE__*/_jsxDEV(StyledIdentificationUploader, {\n        listType: \"picture-card\",\n        showUploadList: false,\n        beforeUpload: beforeUpload,\n        onChange: () => handleChange,\n        customRequest: () => customRequest,\n        children: imageUrl ? /*#__PURE__*/_jsxDEV(StyledIdentificationUploadImage, {\n          src: imageUrl,\n          alt: \"license\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 13\n        }, this) : uploadButton\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(StyledButtonNavDiv, {\n      children: /*#__PURE__*/_jsxDEV(Space, {\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          type: \"primary\",\n          shape: \"circle\",\n          size: \"large\",\n          icon: /*#__PURE__*/_jsxDEV(RightOutlined, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 19\n          }, this),\n          onClick: () => {\n            setCurrentStep(currentStep + 1);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 106,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Identification, \"4yvqHKqjxwz3NQJaiU7QLcDGD4E=\");\n\n_c = Identification;\nexport default Identification;\n\nvar _c;\n\n$RefreshReg$(_c, \"Identification\");","map":{"version":3,"sources":["/Users/farzanhaq/Desktop/PropertyPal/src/components/Booking/Identification/Identification.tsx"],"names":["LoadingOutlined","PlusOutlined","RightOutlined","Button","message","Space","Typography","Auth","Storage","useContext","useState","BookingStatusContext","StyledButtonNavDiv","StyledContentDiv","StyledIdentificationDiv","StyledIdentificationUploadDiv","StyledIdentificationUploadImage","StyledPrompt","StyledIdentificationUploader","getBase64","img","callback","reader","FileReader","addEventListener","result","readAsDataURL","beforeUpload","file","isJpgOrPng","type","error","isLt2M","size","performUpload","user","currentAuthenticatedUser","console","log","put","attributes","sub","userWithPicture","updateUserAttributes","key","err","Identification","currentStep","setCurrentStep","loading","setLoading","imageUrl","setImageUrl","handleChange","info","status","originFileObj","uploadButton","customRequest","options","onSuccess","setTimeout"],"mappings":"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","sourcesContent":["import {\n  LoadingOutlined,\n  PlusOutlined,\n  RightOutlined\n} from \"@ant-design/icons\";\nimport { S3ProviderPutOutput } from \"@aws-amplify/storage\";\nimport { Button, message, Space, Typography } from \"antd\";\nimport { Auth, Storage } from \"aws-amplify\";\nimport { useContext, useState } from \"react\";\nimport { BookingStatusContext } from \"../../../utils/BookingState\";\nimport {\n  StyledButtonNavDiv,\n  StyledContentDiv,\n  StyledIdentificationDiv,\n  StyledIdentificationUploadDiv\n} from \"../../Styles/Div.style\";\nimport { StyledIdentificationUploadImage } from \"../../Styles/Image.style\";\nimport { StyledPrompt } from \"../../Styles/Title.style\";\nimport { StyledIdentificationUploader } from \"../../Styles/Upload.style\";\n\nconst getBase64 = (\n  img: Blob,\n  callback: { (imageUrl: any): void; (arg0: string | ArrayBuffer | null): any }\n) => {\n  const reader = new FileReader();\n  reader.addEventListener(\"load\", () => callback(reader.result));\n  reader.readAsDataURL(img);\n};\n\nconst beforeUpload = (file: { type: string; size: number }) => {\n  const isJpgOrPng = file.type === \"image/jpeg\" || file.type === \"image/png\";\n\n  if (!isJpgOrPng) {\n    message.error(\"Please upload a JPG/PNG file\");\n  }\n\n  const isLt2M = file.size / 1024 / 1024 < 2;\n\n  if (!isLt2M) {\n    message.error(\"Image must smaller than 2MB\");\n  }\n\n  performUpload(file);\n\n  return isJpgOrPng && isLt2M;\n};\n\nconst performUpload = async (file: { type: string; size: number; }) => {\n  try {\n    const user = await Auth.currentAuthenticatedUser();\n    console.log(user)\n    const result: S3ProviderPutOutput = await Storage.put(\n      `identifications/${user.attributes.sub}`,\n      file\n    );\n\n    const userWithPicture = await Auth.updateUserAttributes(user, {\n      'picture': result.key,\n    });\n    console.log(userWithPicture)\n  } catch (err) {\n    console.log(err);\n  }\n};\n\nconst Identification = () => {\n  const { currentStep, setCurrentStep } = useContext(BookingStatusContext);\n  const [loading, setLoading] = useState<boolean>(false);\n  const [imageUrl, setImageUrl] = useState<string>(\"\");\n\n  const handleChange = (info: {\n    file: { status: string; originFileObj: Blob };\n  }) => {\n    console.log(info);\n    if (info.file.status === \"uploading\") {\n      setLoading(true);\n      return;\n    }\n\n    if (info.file.status === \"done\") {\n      // Get this url from response in real world.\n      getBase64(info.file.originFileObj, (imageUrl) => {\n        setImageUrl(imageUrl);\n        setLoading(false);\n      });\n    }\n  };\n\n  const uploadButton = (\n    <div>\n      {loading ? <LoadingOutlined /> : <PlusOutlined />}\n      <StyledIdentificationUploadDiv>Upload</StyledIdentificationUploadDiv>\n    </div>\n  );\n\n  const customRequest = (options: any) => {\n    const { onSuccess, file } = options;\n\n    console.log(file);\n    setTimeout(() => {\n      onSuccess(\"ok\");\n    }, 0);\n  };\n\n  return (\n    <StyledIdentificationDiv>\n      <Typography>\n        <StyledPrompt level={5}>\n          Please upload a photo of your drivers license\n        </StyledPrompt>\n      </Typography>\n      <StyledContentDiv>\n        <StyledIdentificationUploader\n          listType=\"picture-card\"\n          showUploadList={false}\n          beforeUpload={beforeUpload}\n          onChange={() => handleChange}\n          customRequest={() => customRequest}\n        >\n          {imageUrl ? (\n            <StyledIdentificationUploadImage src={imageUrl} alt=\"license\" />\n          ) : (\n            uploadButton\n          )}\n        </StyledIdentificationUploader>\n      </StyledContentDiv>\n      <br />\n      <br />\n      <StyledButtonNavDiv>\n        <Space>\n          <Button\n            type=\"primary\"\n            shape=\"circle\"\n            size=\"large\"\n            icon={<RightOutlined />}\n            onClick={() => {\n              setCurrentStep(currentStep + 1);\n            }}\n          />\n        </Space>\n      </StyledButtonNavDiv>\n    </StyledIdentificationDiv>\n  );\n};\n\nexport default Identification;\n"]},"metadata":{},"sourceType":"module"}